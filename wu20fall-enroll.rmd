---
title: "Webster University 2020 Fall Enrollment Analysis"
author: "Mandy HP Nguyen"
date: "01/04/2022"
output:
  pdf_document:
    toc: yes
    toc_depth: '4'
  html_document:
    theme: paper
    highlight: breezedark
    code_folding: hide
    toc: yes
    toc_depth: 4
    toc_float: yes
    number_sections: yes
  word_document:
    toc: yes
    toc_depth: '4'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Environment Setting

## Load Mandy's Functions

```{r}
source("https://raw.githubusercontent.com/mandyhpnguyen/Mandy-Functions/main/M.R-Funcs/general.R")
```

## Load Packages

```{r}
pkgs <- c(
  "beepr",
  # General pkgs:
  "tidyverse", "dplyr", "summarytools", "reshape2", "pastecs",
  # Analytics pkgs:
  "forecast", "zoo", "scorecard", "ts",
  # Evaluation pkgs:
  "caret", "DT", "lift", "gains", "gt", "cvms", "tibble", "fourfoldplot",
  # Visualization pkgs:
  "RColorBrewer", "hrbrthemes", "knitr", "showtext", "sysfonts",
  "ggfortify", "ggplot2", "corrplot", "GGally", "viridis",
  "lattice", "grid", "cowplot", "Amelia"
)
suppressMessages(suppressWarnings(loadpkg(pkgs)))
```

## Set fonts

```{r}
# Load the main font I used in my paper to plot charts for standardization
windowsFonts(cambria = windowsFont("Cambria"),
             franklin = windowsFont("Franklin Gothic Book"))
my.par <- function() {
  options(scipen = 999)
  par(mfrow = c(1, 1),
      family = "franklin", 
      cex.main = 1.25, cex.lab = 1.25, cex.axis = 1.25)
}
```

## Color Scheme

```{r}
pal <- c("#3A4E84", "#FFAF50", "#4698CA", "#E66622", "#EEEEEE")
# Source: https://webster.edu/website-training-resources/editorial-style-color-palette.php
```

# Collect Data

```{r}
allus20 <- read.csv("https://raw.githubusercontent.com/mandyhpnguyen/Webster-University_Fall-2020_Enrollment_Analysis/main/Data/Final_All_School_US_2020/2020_US_Institutions_data.csv")
wu_race <- read.csv("https://raw.githubusercontent.com/mandyhpnguyen/Webster-University_Fall-2020_Enrollment_Analysis/c24ea4275e71587c9ecbb0a07a9843ae561bbcf4/Data/Final_WU_Race_2016-2020/WU_20_Race_data.csv")
wu_gender <- read.csv("https://raw.githubusercontent.com/mandyhpnguyen/Webster-University_Fall-2020_Enrollment_Analysis/main/Data/Final_WU_Gender_2016-2020/WU_20_Gender_data.csv")
```

# WebsterU Race

```{r}
round(stat.desc(wu_race), 0)
summary(wu_race)
str(wu_race)
```

```{r}
race.df <- wu_race
race.df <- race.df[, -1]
race.df$Year <- factor(race.df$Year)
```

```{r}
year_totals <- race.df %>%
    group_by(Race, Year) %>%
    summarise(Student = sum(Student))
race.df.new <- add_row(.data = race.df, year_totals) %>%
    arrange(Race, Year)
race.df.new$Gender[is.na(race.df.new$Gender)] <- "Total"
# source: https://stackoverflow.com/questions/66136737/add-total-row-for-each-group-in-a-column-in-df
```


```{r}
race.df20 <- race.df.new[race.df.new["Gender"] == "Total" & race.df.new["Year"] == "2020", c(1,4)] %>% arrange(Student)
```

```{r}
my.par() %>% par(mfrow = c(1, 1),
                 mai = par("mai") * 1,
                 oma = c(0,0,0,0) + 0.1,
                 mar = c(3,20,0,1) + 0.1)
barplot(height = race.df20$Student, horiz = TRUE, col = pal[1],
        names.arg = race.df20$Race, las = 1)
```

```{r}
ggplot(race.df, aes(fill = Year, y = Student, x = Race)) + 
  geom_bar(position = "dodge", stat = "identity") +
  coord_flip()
```



# Clean up

```{r}
rm(list = ls())
cat("\014")
```